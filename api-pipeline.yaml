# Help:  https://aka.ms/yaml

resources:
- repo: self

trigger:
- master

variables:
  chart-root: deployment/helm-chart
  chart-name: ParserAsServiceApi
  chart-path: $(chart-root)/$(chart-name)
  image-name:  vplauzon/pas-api

stages:
  - stage: build
    displayName: build
    dependsOn:  []
    jobs:
      - template: helm-build.yaml
        parameters:
          deploymentName:  deploy_helm_${{ parameters.environment }}
          deployment-display-name:  Deploy Helm in ${{ parameters.environment }}
          app-version-cs-path:  PasWebApi/ApiVersion.cs

  - stage: dev
    displayName: dev
    dependsOn:  build
    jobs:
      - template: helm-deploy.yaml
        parameters:
          environment:  dev
